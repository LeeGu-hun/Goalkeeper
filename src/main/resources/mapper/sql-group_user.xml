<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="goal.mapper.GroupUserMapper">
	<resultMap type="goal.vo.GroupUserVO" id="groupUserVO">
		<id property="sno" column="sno"/>
		<id property="uno" column="uno"/>
		<id property="gno" column="gno"/>
		<id property="userId" column="userId"/>
		<id property="g_role" column="g_role"/>
		<id property="g_date" column="g_date"/>
	</resultMap>
	<insert id="insertGroupUser" parameterType="goal.vo.GroupUserVO">
		<selectKey keyProperty="sno" resultType="int" order="BEFORE">
			select GK_SGROUP_SEQ.nextval from dual
		</selectKey>
		insert into
		GK_GROUP_USER(sno, uno, gno, g_role, g_date) values
		(GK_SGROUP_SEQ.currval, #{uno}, #{gno},
		#{g_role}, sysdate)
	</insert>
	<select id="findUserbyGroup" parameterType="int" resultMap="groupUserVO">
		<![CDATA[
			select sno, g.uno, gno, g_role, userId, g_date from GK_GROUP_USER G, GK_USER U where G.UNO = U.UNO and g.gno=#{gno}
		]]>
	</select>
	<select id="countUserbyGroup" parameterType="int" resultType="int">
		select count(*) from gk_group_user where gno=#{gno}
	</select>
	<select id="checkUserbyGroup" parameterType="goal.vo.GroupUserVO" resultType="int">
		select count(*) from gk_group_user where uno=#{uno} and gno=#{gno}
	</select>
	<select id="findRolebyUser" parameterType="goal.vo.GroupUserVO" resultType="String">
		select g_role from gk_group_user where uno=#{uno} and gno=#{gno}
	</select>
	<select id="findGroupbyUno" parameterType="int" resultType="goal.vo.GroupVO">
		select GNO, UNO, G_NAME, G_DATE, G_INTRO, G_CATE, G_OPEN, FILE_CHECK, BGI_CHECK from gk_allgroup a, gk_group_user u where a.gno=u.gno and u.uno=#{uno]
	</select>
</mapper>