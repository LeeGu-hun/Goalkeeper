<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="goal.mapper.ReplyMapper">
	<resultMap type="goal.vo.ReplyVO" id="replyVO">
		<id property="replyWriter" column="replyWriter"/>
		<id property="replyContent" column="replyContent"/>
		<id property="bno" column="bno"/>
		<id property="replyDate" column="replyDate"/>
	</resultMap>
	
	<select id="readMainReply" parameterType="int" resultMap="replyVO">
		select bno, replyWriter ,replyContent ,replyDate from GK_COMMENT order by replyDate
		<!-- <![CDATA[
			select * from( select rownum rn, t.* from(select bno, replyWriter ,replyContent ,replyDate from GK_COMMENT where bno = #{bno} ORDER BY replyDate DESC) t) where rn<=2
		]]> -->
	</select>
	
	<select id="countReply" parameterType="int" resultType="int">
        SELECT COUNT(*) FROM GK_COMMENT where bno=#{bno}
    </select>
	
	<insert id="insertReply" parameterType="goal.vo.ReplyVO">
		insert into
		GK_COMMENT(rno, bno, replyWriter ,replyContent ,replyDate) values
		(GK_COMMENT_SEQ.nextval, #{bno}, #{replyWriter}, #{replyContent}, sysdate)
	</insert>
</mapper>